import chisel3._
import chiseltest._
import org.scalatest.flatspec.AnyFlatSpec
import java.util

object Programs {
  val program1 = Array(
    "h88010000".U(32.W),  // 0x0000: ADDI $r1, $r0, 0
    "hC0000006".U(32.W),  // 0x0001: JUMP 0x0006  // FIXED: Jump to 6 to initialize r6 first
    "h40C10000".U(32.W),  // 0x0002: ADD  $r6, $r1, $r0
    "h88C60190".U(32.W),  // 0x0003: ADDI $r6, $r6, 400
    "h84C00000".U(32.W),  // 0x0004: STORE $r0, 0($r6)
    "h88210001".U(32.W),  // 0x0005: ADDI $r1, $r1, 1
    "h8806018F".U(32.W),  // 0x0006: ADDI $r6, $r0, 399
    "h90260028".U(32.W),  // 0x0007: BEQ  $r1, $r6, 40    // FIXED: Jump to address 40 (0x28) where END is
    "h80220000".U(32.W),  // 0x0008: LOAD $r2, 0($r1)
    "h90400003".U(32.W),  // 0x0009: BEQ  $r2, $r0, 3
    "h88060013".U(32.W),  // 0x000A: ADDI $r6, $r0, 19
    "h94C30003".U(32.W),  // 0x000B: BGE  $r6, $r3, 3
    "h8803017B".U(32.W),  // 0x000C: ADDI $r3, $r0, 379
    "h94660003".U(32.W),  // 0x000D: BGE  $r3, $r6, 3
    "h40810000".U(32.W),  // 0x000E: ADD  $r4, $r1, $r0
    "h8C840014".U(32.W),  // 0x000F: SUBI $r4, $r4, 20
    "h94800010".U(32.W),  // 0x0010: BGE  $r4, $r0, 16
    "h88840014".U(32.W),  // 0x0011: ADDI $r4, $r4, 20
    "h90800003".U(32.W),  // 0x0012: BEQ  $r4, $r0, 3
    "h88030013".U(32.W),  // 0x0013: ADDI $r3, $r0, 19
    "h90830003".U(32.W),  // 0x0014: BEQ  $r4, $r3, 3
    "h40A10000".U(32.W),  // 0x0015: ADD  $r5, $r1, $r0
    "h8CA50001".U(32.W),  // 0x0016: SUBI $r5, $r5, 1
    "h80A20000".U(32.W),  // 0x0017: LOAD $r2, 0($r5)
    "h90400003".U(32.W),  // 0x0018: BEQ  $r2, $r0, 3
    "h88A50002".U(32.W),  // 0x0019: ADDI $r5, $r5, 2
    "h80A20000".U(32.W),  // 0x001A: LOAD $r2, 0($r5)
    "h90400003".U(32.W),  // 0x001B: BEQ  $r2, $r0, 3
    "h8CA50001".U(32.W),  // 0x001C: SUBI $r5, $r5, 1
    "h8CA50014".U(32.W),  // 0x001D: SUBI $r5, $r5, 20
    "h80A20000".U(32.W),  // 0x001E: LOAD $r2, 0($r5)
    "h90400003".U(32.W),  // 0x001F: BEQ  $r2, $r0, 3
    "h88A50028".U(32.W),  // 0x0020: ADDI $r5, $r5, 40
    "h80A20000".U(32.W),  // 0x0021: LOAD $r2, 0($r5)
    "h90400003".U(32.W),  // 0x0022: BEQ  $r2, $r0, 3
    "h40C10000".U(32.W),  // 0x0023: ADD  $r6, $r1, $r0
    "h88C60190".U(32.W),  // 0x0024: ADDI $r6, $r6, 400
    "h88070001".U(32.W),  // 0x0025: ADDI $r7, $r0, 1
    "h84C70000".U(32.W),  // 0x0026: STORE $r7, 0($r6)
    "hC0000006".U(32.W),  // 0x0027: JUMP 0x0006
    "h00000000".U(32.W)   // 0x0028: END
  )

  val program2 = Array(
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W),
    "h00000000".U(32.W)
  )

  // Program3: Ultra simple test - just store value 1 at address 400
  val program3 = Array(
    "b10001000000000010000000011111111".U(32.W),
    "b10001000000000100000000000010100".U(32.W),
    "b10001000000000110000000101111100".U(32.W),
    "b10010000010000110000000000011000".U(32.W),
    "b10000000010001000000000000000000".U(32.W),
    "b10010000100000000000000000010110".U(32.W),
    "b10001100010001010000000000010100".U(32.W),
    "b10000000101001000000000000000000".U(32.W),
    "b10010000100000000000000000010110".U(32.W),
    "b10001000010001010000000000010100".U(32.W),
    "b10000000101001000000000000000000".U(32.W),
    "b10010000100000000000000000010110".U(32.W),
    "b10001100010001010000000000000001".U(32.W),
    "b10000000101001000000000000000000".U(32.W),
    "b10010000100000000000000000010110".U(32.W),
    "b10001000010001010000000000000001".U(32.W),
    "b10000000101001000000000000000000".U(32.W),
    "b10010000100000000000000000010110".U(32.W),
    "b10001000010000100000000110010000".U(32.W),
    "b10000100010000010000000000000000".U(32.W),
    "b10001100010000100000000110001111".U(32.W),
    "b11000000000000000000000000000011".U(32.W),
    "b10001000010000100000000000000001".U(32.W),
    "b11000000000000000000000000000011".U(32.W),
    "b00000000000000000000000000000000".U(32.W)
  )

  // Program4: Simple single store test with 255
  val program4 = Array(
    "b10001000000000010000000011111111".U(32.W),
    "b10001000000000100000000110010000".U(32.W),
    "b10001000000000110000000110011010".U(32.W),
    "b10010000010000110000000000000111".U(32.W),
    "b10000100010000010000000000000000".U(32.W),
    "b10001000010000100000000000000001".U(32.W),
    "b11000000000000000000000000000011".U(32.W),
    "b00000000000000000000000000000000".U(32.W)
  )
}
